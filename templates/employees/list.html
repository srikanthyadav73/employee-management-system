{% extends "base.html" %}
{% block content %}

<form method="GET" action="{{ url_for('employee.list_employees') }}" style="margin-bottom:20px;">
    <input type="text" name="search" placeholder="Search by name..."
           value="{{ request.args.get('search', '') }}"
           class="search-input">
    <button type="submit" class="btn-search">Search</button>
</form>

<h2 style="margin-bottom: 20px;">Employees ({{ employees|length }})</h2>

{% if current_user.role == 'admin' %}
<a href="{{ url_for('employee.add_employee') }}" class="btn-primary" style="margin-bottom:15px; display:inline-block;">
    + Add Employee
</a>
{% endif %}

<div class="table-container">
    <table class="employee-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Department</th>
                <th>Role</th>
                <th style="text-align:center;">Actions</th>
            </tr>
        </thead>
           <tbody>
{% for emp in employees %}
<tr>
    <td>{{ emp.name }}</td>
    <td>{{ emp.email }}</td>
    <td>{{ emp.department }}</td>
    <td>{{ emp.role }}</td>

    <td>
        {% if current_user.role == 'admin' %}
        <a href="{{ url_for('employee.edit_employee', id=emp._id) }}" class="btn-edit">Edit</a>
        <a href="{{ url_for('employee.delete_employee', id=emp._id) }}"
           onclick="return confirm('Are you sure?');"
           class="btn-delete">Delete</a>
        {% endif %}
    </td>

</tr>
{% endfor %}
       </tbody>
    </table>
    <div class="pagination">
    {% if page > 1 %}
        <a href="{{ url_for('employee.list_employees', page=page-1, search=search_query) }}">Previous</a>
    {% endif %}

    {% for p in range(1, total_pages + 1) %}
        <a href="{{ url_for('employee.list_employees', page=p, search=search_query) }}"
           class="{% if p == page %}active-page{% endif %}">
           {{ p }}
        </a>
    {% endfor %}

    {% if page < total_pages %}
        <a href="{{ url_for('employee.list_employees', page=page+1, search=search_query) }}">Next</a>
    {% endif %}
</div>

</div>

{% endblock %}
